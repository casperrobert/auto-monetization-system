cd /workspaces/auto-monetization-system
mkdir -p public/js

# dashboard.html
cat > public/dashboard.html <<'HTML'
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard · CASPER SYSTEM 24</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://unpkg.com/web3@1.10.0/dist/web3.min.js"></script>
</head>
<body>
<header class="site-header">
  <div class="container header-inner">
    <a class="brand" href="index.html">CASPER SYSTEM 24</a>
    <nav class="site-nav"><a href="index.html">Home</a></nav>
  </div>
</header>

<main class="section">
  <div class="container">
    <h1>Realtime Dashboard</h1>
    <p class="muted">Einstellungen werden lokal gespeichert. Backendless ist optional.</p>

    <div class="grid-2">
      <section class="panel">
        <h2>1) Einstellungen</h2>
        <form class="cfg">
          <label>Affiliate-Tag (zon)<input id="cfg-aff" placeholder="dein-tag-21"></label>
          <label>Backendless APP_ID<input id="cfg-app" placeholder="APP_ID"></label>
          <label>Backendless API_KEY<input id="cfg-key" placeholder="REST_API_KEY"></label>
          <label>Log-Tabelle<input id="cfg-table" value="Transactions"></label>
          <div class="row">
            <button type="button" id="save-cfg" class="btn btn-primary">Speichern</button>
            <button type="button" id="clear-cfg" class="btn btn-ghost">Löschen</button>
          </div>
        </form>
      </section>

      <section class="panel">
        <h2>2) Wallet verbinden</h2>
        <button id="btn-connect" class="btn btn-primary">Mit Metsk verbinden</button>
        <div id="wallet-info" class="tiny muted"></div>
        <div class="row">
          <label>Betrag (ETH)<input id="send-amount" type="number" step="0.0001" placeholder="0.01"></label>
          <label>An Adresse<input id="send-to" placeholder="0xEmpfänger..."></label>
        </div>
        <button id="btn-send" class="btn">Test-Transaktion senden</button>
        <pre id="tx-out" class="code"></pre>
      </section>

      <section class="panel">
        <h2>3) Live-Preise</h2>
        <div class="row">
          <button id="btn-prices" class="btn">Aktualisieren</button>
          <span id="price-ts" class="tiny muted"></span>
        </div>
        <table class="table" id="price-table">
          <thead><tr><th>Asset</th><th>Preis (USD)</th><th>24h %</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>

      <section class="panel">
        <h2>4) Affiliate-Link Generator</h2>
        <label>zon-Produkt-URL<input id="aff-url" placeholder="https://www.zon.de/dp/ASIN…"></label>
        <button id="btn-build" class="btn">Link erzeugen</button>
        <input id="aff-out" readonly placeholder="Ergebnis erscheint hier">
      </section>

      <section class="panel">
        <h2>5) Einnahmen-Log</h2>
        <div class="row">
          <label>Betrag<input id="log-amount" type="number" step="0.01" placeholder="5.00"></label>
          <label>Quelle<input id="log-source" placeholder="zon / Shoop / Crypto"></label>
          <button id="btn-log" class="btn">Speichern</button>
        </div>
        <table class="table" id="log-table">
          <thead><tr><th>Zeit</th><th>Quelle</th><th>Betrag</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>
    </div>
  </div>
</main>

<footer class="site-footer">
  <div class="container footer-inner">© <span id="year"></span> CASPER SYSTEM 24</div>
</footer>

<script src="js/erc20.js"></script>
<script src="js/dashboard.js"></script>
</body>
</html>
HTML

# js/erc20.js (Mini-ABI)
cat > public/js/erc20.js <<'JS'
window.CASPER_ERC20_ABI = [
  {"constant":true,"inputs":[{"name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"type":"function"},
  {"constant":false,"inputs":[{"name":"to","type":"address"},{"name":"value","type":"uint256"}],"name":"transfer","outputs":[{"name":"","type":"bool"}],"type":"function"},
  {"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"type":"function"},
  {"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"type":"function"}
];
JS

# js/dashboard.js (Logik)
cat > public/js/dashboard.js <<'JS'
(function(){
  const $=s=>document.querySelector(s);
  const y=document.getElementById('year'); if(y) y.textContent=new Date().getFullYear();

  // Config lokal speichern
  const lsKey='casper24_cfg';
  const cfg = JSON.parse(localStorage.getItem(lsKey) || '{"affTag":"","appId":"","apiKey":"","table":"Transactions"}');
  const set=()=>localStorage.setItem(lsKey, JSON.stringify(cfg));
  const val=(id)=>{const el=$(id); return el?el.value.trim():""};

  const aff=$('#cfg-aff'), app=$('#cfg-app'), key=$('#cfg-key'), tab=$('#cfg-table');
  if(aff) aff.value=cfg.affTag; if(app) app.value=cfg.appId; if(key) key.value=cfg.apiKey; if(tab) tab.value=cfg.table||'Transactions';
  $('#save-cfg')?.addEventListener('click',()=>{ cfg.affTag=aff.value.trim(); cfg.appId=app.value.trim(); cfg.apiKey=key.value.trim(); cfg.table=tab.value.trim()||'Transactions'; set(); alert('Gespeichert.'); });
  $('#clear-cfg')?.addEventListener('click',()=>{ localStorage.removeItem(lsKey); location.reload(); });

  // Wallet
  let web3;
  const out = (m)=>{ const el=$('#tx-out'); if(el) el.textContent=(el.textContent+'\n'+m).trim(); };
  $('#btn-connect')?.addEventListener('click', async()=>{
    try{
      if(!window.ethereum){ alert('Metsk nicht gefunden'); return; }
      await window.ethereum.request({method:'eth_requestAccounts'});
      web3 = new Web3(window.ethereum);
      const [acc] = await web3.eth.getAccounts();
      $('#wallet-info').textContent = 'Verbunden: '+acc;
    }catch(e){ out('Wallet-Fehler: '+e.message); }
  });
  $('#btn-send')?.addEventListener('click', async()=>{
    try{
      if(!web3){ alert('Erst Wallet verbinden'); return; }
      const to = val('#send-to'); const eth = parseFloat(val('#send-amount'));
      if(!/^0x[a-fA-F0-9]{40}$/.test(to)) return alert('Zieladresse prüfen');
      if(!(eth>0)) return alert('Betrag eingeben');
      const [from] = await web3.eth.getAccounts();
      const value = web3.utils.toWei(String(eth),'ether');
      const tx = await web3.eth.sendTransaction({from,to,value});
      out('TX: '+tx.transactionHash);
    }catch(e){ out('Senden fehlgeschlagen: '+e.message); }
  });

  // Preise (CoinGecko)
  const loadPrices = async ()=>{
    try{
      const ids='bitcoin,ethereum,solana';
      const r = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${ids}&vs_currencies=usd&include_24hr_change=true`);
      if(!r.ok) throw new Error('API '+r.status);
      const d = await r.json();
      const tb = document.querySelector('#price-table tbody'); if(!tb) return;
      tb.innerHTML='';
      [['Bitcoin','bitcoin'],['Ethereum','ethereum'],['Solana','solana']].forEach(([n,k])=>{
        const p=d[k]; const tr=document.createElement('tr');
        tr.innerHTML = `<td>${n}</td><td>${p.usd.toLocaleString('en-US',{maximumFractionDigits:2})}</td><td>${(p.usd_24h_change||0).toFixed(2)}%</td>`;
        tb.appendChild(tr);
      });
      $('#price-ts').textContent='Aktualisiert: '+new Date().toLocaleTimeString();
    }catch{ $('#price-ts').textContent='Preisfeed nicht erreichbar'; }
  };
  $('#btn-prices')?.addEventListener('click', loadPrices);
  loadPrices();

  // Affiliate-Link
  $('#btn-build')?.addEventListener('click', ()=>{
    const url = val('#aff-url');
    if(!url) return alert('URL einfügen');
    if(!cfg.affTag) return alert('Affiliate-Tag in den Einstellungen speichern');
    try{
      const u=new URL(url);
      if(!u.hostname.includes('zon.')) return alert('Keine zon-URL');
      u.searchParams.set('tag', cfg.affTag);
      $('#aff-out').value = u.toString();
    }catch{ alert('Ungültige URL'); }
  });

  // Einnahmen-Log lokal
  const logKey='casper24_logs';
  const read=()=>JSON.parse(localStorage.getItem(logKey)||'[]');
  const write=(r)=>localStorage.setItem(logKey,JSON.stringify(r));
  const render=()=>{ const rows=read(); const tb=document.querySelector('#log-table tbody'); if(!tb) return; tb.innerHTML=''; rows.forEach(r=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${new Date(r.ts).toLocaleString()}</td><td>${r.source}</td><td>${Number(r.amount).toFixed(2)}</td>`; tb.appendChild(tr); }); };
  $('#btn-log')?.addEventListener('click', ()=>{
    const a=parseFloat(val('#log-amount')); const s=val('#log-source')||'Manuell';
    if(!(a>0)) return alert('Betrag eingeben');
    const rows=read(); rows.unshift({ts:Date.now(),source:s,amount:a}); write(rows); render();
    $('#log-amount').value=''; $('#log-source').value='';
  });
  render();
})();
JS
